"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));

var _helpers = require("../../lib/helpers");

var _appiumTestSupport = require("appium-test-support");

var _appiumSupport = require("appium-support");

var _path = _interopRequireDefault(require("path"));

var _lodash = _interopRequireDefault(require("lodash"));

describe('helpers', (0, _appiumTestSupport.withMocks)({
  fs: _appiumSupport.fs
}, function (mocks) {
  afterEach(function () {
    mocks.verify();
  });
  describe('getAndroidPlatformAndPath', function () {
    let oldAndroidHome;
    before(function () {
      oldAndroidHome = process.env.ANDROID_HOME;
    });
    after(function () {
      process.env.ANDROID_HOME = oldAndroidHome;
    });
    it('should get the latest available API', (0, _asyncToGenerator2.default)(function* () {
      process.env.ANDROID_HOME = '/path/to/android/home';
      mocks.fs.expects('glob').returns([_path.default.resolve(process.env.ANDROID_HOME, 'platforms', 'android-17', 'build.prop'), _path.default.resolve(process.env.ANDROID_HOME, 'platforms', 'android-25', 'build.prop'), _path.default.resolve(process.env.ANDROID_HOME, 'platforms', 'android-22', 'build.prop')]);
      mocks.fs.expects('readFile').exactly(3).onCall(0).returns(`
          ro.build.version.incremental=1425461
          ro.build.version.sdk=17
          ro.build.version.codename=REL
          ro.build.version.release=4.2.2`).onCall(1).returns(`
          ro.build.version.incremental=1425461
          ro.build.version.sdk=25
          ro.build.version.codename=REL
          ro.build.version.release=7.0`).onCall(2).returns(`
          ro.build.version.incremental=1425461
          ro.build.version.sdk=22
          ro.build.version.codename=REL
          ro.build.version.release=5.1`);
      let platformAndPath = yield (0, _helpers.getAndroidPlatformAndPath)();
      platformAndPath.platform.should.equal('android-25');
      platformAndPath.platformPath.should.equal(_path.default.resolve(process.env.ANDROID_HOME, 'platforms', 'android-25'));
    }));
  });
  describe('isShowingLockscreen', function () {
    it('should return true if mShowingLockscreen is true', (0, _asyncToGenerator2.default)(function* () {
      let dumpsys = 'mShowingLockscreen=true mShowingDream=false mDreamingLockscreen=false mTopIsFullscreen=false';
      (yield (0, _helpers.isShowingLockscreen)(dumpsys)).should.be.true;
    }));
    it('should return true if mDreamingLockscreen is true', (0, _asyncToGenerator2.default)(function* () {
      let dumpsys = 'mShowingLockscreen=false mShowingDream=false mDreamingLockscreen=true mTopIsFullscreen=false';
      (yield (0, _helpers.isShowingLockscreen)(dumpsys)).should.be.true;
    }));
    it('should return false if mShowingLockscreen and mDreamingLockscreen are false', (0, _asyncToGenerator2.default)(function* () {
      let dumpsys = 'mShowingLockscreen=false mShowingDream=false mDreamingLockscreen=false mTopIsFullscreen=false';
      (yield (0, _helpers.isShowingLockscreen)(dumpsys)).should.be.false;
    }));
    it('should assume that screen is unlocked if can not determine lock state', (0, _asyncToGenerator2.default)(function* () {
      let dumpsys = 'mShowingDream=false mTopIsFullscreen=false';
      (yield (0, _helpers.isShowingLockscreen)(dumpsys)).should.be.false;
    }));
  });
  describe('buildStartCmd', function () {
    let startOptions = {
      pkg: 'com.something',
      activity: '.SomeActivity'
    };
    it('should parse optionalIntentArguments with single key', function () {
      let cmd = (0, _helpers.buildStartCmd)(_lodash.default.defaults({
        optionalIntentArguments: '-d key'
      }, startOptions), 20);
      cmd[cmd.length - 2].should.eql('-d');
      cmd[cmd.length - 1].should.eql('key');
    });
    it('should parse optionalIntentArguments with single key/value pair', function () {
      let cmd = (0, _helpers.buildStartCmd)(_lodash.default.defaults({
        optionalIntentArguments: '-d key value'
      }, startOptions), 20);
      cmd[cmd.length - 3].should.eql('-d');
      cmd[cmd.length - 2].should.eql('key');
      cmd[cmd.length - 1].should.eql('value');
    });
    it('should parse optionalIntentArguments with single key/value pair with spaces', function () {
      let cmd = (0, _helpers.buildStartCmd)(_lodash.default.defaults({
        optionalIntentArguments: '-d key value value2'
      }, startOptions), 20);
      cmd[cmd.length - 3].should.eql('-d');
      cmd[cmd.length - 2].should.eql('key');
      cmd[cmd.length - 1].should.eql('value value2');
    });
    it('should parse optionalIntentArguments with multiple keys', function () {
      let cmd = (0, _helpers.buildStartCmd)(_lodash.default.defaults({
        optionalIntentArguments: '-d key1 -e key2'
      }, startOptions), 20);
      cmd[cmd.length - 4].should.eql('-d');
      cmd[cmd.length - 3].should.eql('key1');
      cmd[cmd.length - 2].should.eql('-e');
      cmd[cmd.length - 1].should.eql('key2');
    });
    it('should parse optionalIntentArguments with multiple key/value pairs', function () {
      let cmd = (0, _helpers.buildStartCmd)(_lodash.default.defaults({
        optionalIntentArguments: '-d key1 value1 -e key2 value2'
      }, startOptions), 20);
      cmd[cmd.length - 6].should.eql('-d');
      cmd[cmd.length - 5].should.eql('key1');
      cmd[cmd.length - 4].should.eql('value1');
      cmd[cmd.length - 3].should.eql('-e');
      cmd[cmd.length - 2].should.eql('key2');
      cmd[cmd.length - 1].should.eql('value2');
    });
    it('should parse optionalIntentArguments with hyphens', function () {
      let arg = 'http://some-url-with-hyphens.com/';
      let cmd = (0, _helpers.buildStartCmd)(_lodash.default.defaults({
        optionalIntentArguments: `-d ${arg}`
      }, startOptions), 20);
      cmd[cmd.length - 2].should.eql('-d');
      cmd[cmd.length - 1].should.eql(arg);
    });
    it('should parse optionalIntentArguments with multiple arguments with hyphens', function () {
      let arg1 = 'http://some-url-with-hyphens.com/';
      let arg2 = 'http://some-other-url-with-hyphens.com/';
      let cmd = (0, _helpers.buildStartCmd)(_lodash.default.defaults({
        optionalIntentArguments: `-d ${arg1} -e key ${arg2}`
      }, startOptions), 20);
      cmd[cmd.length - 5].should.eql('-d');
      cmd[cmd.length - 4].should.eql(arg1);
      cmd[cmd.length - 3].should.eql('-e');
      cmd[cmd.length - 2].should.eql('key');
      cmd[cmd.length - 1].should.eql(arg2);
    });
    it('should have -S option when stopApp is set', function () {
      let cmd = (0, _helpers.buildStartCmd)(_lodash.default.defaults({
        stopApp: true
      }, startOptions), 20);
      cmd[cmd.length - 1].should.eql('-S');
    });
    it('should not have -S option when stopApp is not set', function () {
      let cmd = (0, _helpers.buildStartCmd)(_lodash.default.defaults({
        stopApp: false
      }, startOptions), 20);
      cmd[cmd.length - 1].should.not.eql('-S');
    });
  });
  describe('getBuildToolsDirs', function () {
    it('should sort build-tools folder names by semantic version', (0, _asyncToGenerator2.default)(function* () {
      mocks.fs.expects('glob').once().returns(['/some/path/1.2.3', '/some/path/4.5.6', '/some/path/2.3.1']);
      (yield (0, _helpers.getBuildToolsDirs)('/dummy/path')).should.be.eql(['/some/path/4.5.6', '/some/path/2.3.1', '/some/path/1.2.3']);
    }));
  });
}));require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvdW5pdC9oZWxwZXItc3BlY3MuanMiXSwibmFtZXMiOlsiZGVzY3JpYmUiLCJmcyIsIm1vY2tzIiwiYWZ0ZXJFYWNoIiwidmVyaWZ5Iiwib2xkQW5kcm9pZEhvbWUiLCJiZWZvcmUiLCJwcm9jZXNzIiwiZW52IiwiQU5EUk9JRF9IT01FIiwiYWZ0ZXIiLCJpdCIsImV4cGVjdHMiLCJyZXR1cm5zIiwicGF0aCIsInJlc29sdmUiLCJleGFjdGx5Iiwib25DYWxsIiwicGxhdGZvcm1BbmRQYXRoIiwicGxhdGZvcm0iLCJzaG91bGQiLCJlcXVhbCIsInBsYXRmb3JtUGF0aCIsImR1bXBzeXMiLCJiZSIsInRydWUiLCJmYWxzZSIsInN0YXJ0T3B0aW9ucyIsInBrZyIsImFjdGl2aXR5IiwiY21kIiwiXyIsImRlZmF1bHRzIiwib3B0aW9uYWxJbnRlbnRBcmd1bWVudHMiLCJsZW5ndGgiLCJlcWwiLCJhcmciLCJhcmcxIiwiYXJnMiIsInN0b3BBcHAiLCJub3QiLCJvbmNlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTs7QUFFQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFHQUEsUUFBUSxDQUFDLFNBQUQsRUFBWSxrQ0FBVTtBQUFDQyxFQUFBQSxFQUFFLEVBQUZBO0FBQUQsQ0FBVixFQUFnQixVQUFVQyxLQUFWLEVBQWlCO0FBQ25EQyxFQUFBQSxTQUFTLENBQUMsWUFBWTtBQUNwQkQsSUFBQUEsS0FBSyxDQUFDRSxNQUFOO0FBQ0QsR0FGUSxDQUFUO0FBSUFKLEVBQUFBLFFBQVEsQ0FBQywyQkFBRCxFQUE4QixZQUFZO0FBQ2hELFFBQUlLLGNBQUo7QUFDQUMsSUFBQUEsTUFBTSxDQUFDLFlBQVk7QUFDakJELE1BQUFBLGNBQWMsR0FBR0UsT0FBTyxDQUFDQyxHQUFSLENBQVlDLFlBQTdCO0FBQ0QsS0FGSyxDQUFOO0FBR0FDLElBQUFBLEtBQUssQ0FBQyxZQUFZO0FBQ2hCSCxNQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWUMsWUFBWixHQUEyQkosY0FBM0I7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Q29udGVudCI6WyJpbXBvcnQgeyBnZXRBbmRyb2lkUGxhdGZvcm1BbmRQYXRoLFxuICAgICAgICAgYnVpbGRTdGFydENtZCwgaXNTaG93aW5nTG9ja3NjcmVlbiwgZ2V0QnVpbGRUb29sc0RpcnMgfSBmcm9tICcuLi8uLi9saWIvaGVscGVycyc7XG5pbXBvcnQgeyB3aXRoTW9ja3MgfSBmcm9tICdhcHBpdW0tdGVzdC1zdXBwb3J0JztcbmltcG9ydCB7IGZzIH0gZnJvbSAnYXBwaXVtLXN1cHBvcnQnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuXG5cbmRlc2NyaWJlKCdoZWxwZXJzJywgd2l0aE1vY2tzKHtmc30sIGZ1bmN0aW9uIChtb2Nrcykge1xuICBhZnRlckVhY2goZnVuY3Rpb24gKCkge1xuICAgIG1vY2tzLnZlcmlmeSgpO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0QW5kcm9pZFBsYXRmb3JtQW5kUGF0aCcsIGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgb2xkQW5kcm9pZEhvbWU7XG4gICAgYmVmb3JlKGZ1bmN0aW9uICgpIHtcbiAgICAgIG9sZEFuZHJvaWRIb21lID0gcHJvY2Vzcy5lbnYuQU5EUk9JRF9IT01FO1xuICAgIH0pO1xuICAgIGFmdGVyKGZ1bmN0aW9uICgpIHtcbiAgICAgIHByb2Nlc3MuZW52LkFORFJPSURfSE9NRSA9IG9sZEFuZHJvaWRIb21lO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBnZXQgdGhlIGxhdGVzdCBhdmFpbGFibGUgQVBJJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgcHJvY2Vzcy5lbnYuQU5EUk9JRF9IT01FID0gJy9wYXRoL3RvL2FuZHJvaWQvaG9tZSc7XG5cbiAgICAgIG1vY2tzLmZzLmV4cGVjdHMoJ2dsb2InKS5yZXR1cm5zKFtcbiAgICAgICAgcGF0aC5yZXNvbHZlKHByb2Nlc3MuZW52LkFORFJPSURfSE9NRSwgJ3BsYXRmb3JtcycsICdhbmRyb2lkLTE3JywgJ2J1aWxkLnByb3AnKSxcbiAgICAgICAgcGF0aC5yZXNvbHZlKHByb2Nlc3MuZW52LkFORFJPSURfSE9NRSwgJ3BsYXRmb3JtcycsICdhbmRyb2lkLTI1JywgJ2J1aWxkLnByb3AnKSxcbiAgICAgICAgcGF0aC5yZXNvbHZlKHByb2Nlc3MuZW52LkFORFJPSURfSE9NRSwgJ3BsYXRmb3JtcycsICdhbmRyb2lkLTIyJywgJ2J1aWxkLnByb3AnKSxcbiAgICAgIF0pO1xuICAgICAgbW9ja3MuZnMuZXhwZWN0cygncmVhZEZpbGUnKVxuICAgICAgICAuZXhhY3RseSgzKVxuICAgICAgICAub25DYWxsKDApLnJldHVybnMoYFxuICAgICAgICAgIHJvLmJ1aWxkLnZlcnNpb24uaW5jcmVtZW50YWw9MTQyNTQ2MVxuICAgICAgICAgIHJvLmJ1aWxkLnZlcnNpb24uc2RrPTE3XG4gICAgICAgICAgcm8uYnVpbGQudmVyc2lvbi5jb2RlbmFtZT1SRUxcbiAgICAgICAgICByby5idWlsZC52ZXJzaW9uLnJlbGVhc2U9NC4yLjJgKVxuICAgICAgICAub25DYWxsKDEpLnJldHVybnMoYFxuICAgICAgICAgIHJvLmJ1aWxkLnZlcnNpb24uaW5jcmVtZW50YWw9MTQyNTQ2MVxuICAgICAgICAgIHJvLmJ1aWxkLnZlcnNpb24uc2RrPTI1XG4gICAgICAgICAgcm8uYnVpbGQudmVyc2lvbi5jb2RlbmFtZT1SRUxcbiAgICAgICAgICByby5idWlsZC52ZXJzaW9uLnJlbGVhc2U9Ny4wYClcbiAgICAgICAgLm9uQ2FsbCgyKS5yZXR1cm5zKGBcbiAgICAgICAgICByby5idWlsZC52ZXJzaW9uLmluY3JlbWVudGFsPTE0MjU0NjFcbiAgICAgICAgICByby5idWlsZC52ZXJzaW9uLnNkaz0yMlxuICAgICAgICAgIHJvLmJ1aWxkLnZlcnNpb24uY29kZW5hbWU9UkVMXG4gICAgICAgICAgcm8uYnVpbGQudmVyc2lvbi5yZWxlYXNlPTUuMWApO1xuICAgICAgbGV0IHBsYXRmb3JtQW5kUGF0aCA9IGF3YWl0IGdldEFuZHJvaWRQbGF0Zm9ybUFuZFBhdGgoKTtcbiAgICAgIHBsYXRmb3JtQW5kUGF0aC5wbGF0Zm9ybS5zaG91bGQuZXF1YWwoJ2FuZHJvaWQtMjUnKTtcbiAgICAgIHBsYXRmb3JtQW5kUGF0aC5wbGF0Zm9ybVBhdGguc2hvdWxkXG4gICAgICAgIC5lcXVhbChwYXRoLnJlc29sdmUocHJvY2Vzcy5lbnYuQU5EUk9JRF9IT01FLCAncGxhdGZvcm1zJywgJ2FuZHJvaWQtMjUnKSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdpc1Nob3dpbmdMb2Nrc2NyZWVuJywgZnVuY3Rpb24gKCkge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIHRydWUgaWYgbVNob3dpbmdMb2Nrc2NyZWVuIGlzIHRydWUnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgZHVtcHN5cyA9ICdtU2hvd2luZ0xvY2tzY3JlZW49dHJ1ZSBtU2hvd2luZ0RyZWFtPWZhbHNlIG1EcmVhbWluZ0xvY2tzY3JlZW49ZmFsc2UgbVRvcElzRnVsbHNjcmVlbj1mYWxzZSc7XG4gICAgICAoYXdhaXQgaXNTaG93aW5nTG9ja3NjcmVlbihkdW1wc3lzKSkuc2hvdWxkLmJlLnRydWU7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gdHJ1ZSBpZiBtRHJlYW1pbmdMb2Nrc2NyZWVuIGlzIHRydWUnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgZHVtcHN5cyA9ICdtU2hvd2luZ0xvY2tzY3JlZW49ZmFsc2UgbVNob3dpbmdEcmVhbT1mYWxzZSBtRHJlYW1pbmdMb2Nrc2NyZWVuPXRydWUgbVRvcElzRnVsbHNjcmVlbj1mYWxzZSc7XG4gICAgICAoYXdhaXQgaXNTaG93aW5nTG9ja3NjcmVlbihkdW1wc3lzKSkuc2hvdWxkLmJlLnRydWU7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZmFsc2UgaWYgbVNob3dpbmdMb2Nrc2NyZWVuIGFuZCBtRHJlYW1pbmdMb2Nrc2NyZWVuIGFyZSBmYWxzZScsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBkdW1wc3lzID0gJ21TaG93aW5nTG9ja3NjcmVlbj1mYWxzZSBtU2hvd2luZ0RyZWFtPWZhbHNlIG1EcmVhbWluZ0xvY2tzY3JlZW49ZmFsc2UgbVRvcElzRnVsbHNjcmVlbj1mYWxzZSc7XG4gICAgICAoYXdhaXQgaXNTaG93aW5nTG9ja3NjcmVlbihkdW1wc3lzKSkuc2hvdWxkLmJlLmZhbHNlO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgYXNzdW1lIHRoYXQgc2NyZWVuIGlzIHVubG9ja2VkIGlmIGNhbiBub3QgZGV0ZXJtaW5lIGxvY2sgc3RhdGUnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgZHVtcHN5cyA9ICdtU2hvd2luZ0RyZWFtPWZhbHNlIG1Ub3BJc0Z1bGxzY3JlZW49ZmFsc2UnO1xuICAgICAgKGF3YWl0IGlzU2hvd2luZ0xvY2tzY3JlZW4oZHVtcHN5cykpLnNob3VsZC5iZS5mYWxzZTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2J1aWxkU3RhcnRDbWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgbGV0IHN0YXJ0T3B0aW9ucyA9IHtcbiAgICAgIHBrZzogJ2NvbS5zb21ldGhpbmcnLFxuICAgICAgYWN0aXZpdHk6ICcuU29tZUFjdGl2aXR5J1xuICAgIH07XG5cbiAgICBpdCgnc2hvdWxkIHBhcnNlIG9wdGlvbmFsSW50ZW50QXJndW1lbnRzIHdpdGggc2luZ2xlIGtleScsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBjbWQgPSBidWlsZFN0YXJ0Q21kKF8uZGVmYXVsdHMoe29wdGlvbmFsSW50ZW50QXJndW1lbnRzOiAnLWQga2V5J30sIHN0YXJ0T3B0aW9ucyksIDIwKTtcbiAgICAgIGNtZFtjbWQubGVuZ3RoIC0gMl0uc2hvdWxkLmVxbCgnLWQnKTtcbiAgICAgIGNtZFtjbWQubGVuZ3RoIC0gMV0uc2hvdWxkLmVxbCgna2V5Jyk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBwYXJzZSBvcHRpb25hbEludGVudEFyZ3VtZW50cyB3aXRoIHNpbmdsZSBrZXkvdmFsdWUgcGFpcicsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBjbWQgPSBidWlsZFN0YXJ0Q21kKF8uZGVmYXVsdHMoe29wdGlvbmFsSW50ZW50QXJndW1lbnRzOiAnLWQga2V5IHZhbHVlJ30sIHN0YXJ0T3B0aW9ucyksIDIwKTtcbiAgICAgIGNtZFtjbWQubGVuZ3RoIC0gM10uc2hvdWxkLmVxbCgnLWQnKTtcbiAgICAgIGNtZFtjbWQubGVuZ3RoIC0gMl0uc2hvdWxkLmVxbCgna2V5Jyk7XG4gICAgICBjbWRbY21kLmxlbmd0aCAtIDFdLnNob3VsZC5lcWwoJ3ZhbHVlJyk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBwYXJzZSBvcHRpb25hbEludGVudEFyZ3VtZW50cyB3aXRoIHNpbmdsZSBrZXkvdmFsdWUgcGFpciB3aXRoIHNwYWNlcycsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBjbWQgPSBidWlsZFN0YXJ0Q21kKF8uZGVmYXVsdHMoe29wdGlvbmFsSW50ZW50QXJndW1lbnRzOiAnLWQga2V5IHZhbHVlIHZhbHVlMid9LCBzdGFydE9wdGlvbnMpLCAyMCk7XG4gICAgICBjbWRbY21kLmxlbmd0aCAtIDNdLnNob3VsZC5lcWwoJy1kJyk7XG4gICAgICBjbWRbY21kLmxlbmd0aCAtIDJdLnNob3VsZC5lcWwoJ2tleScpO1xuICAgICAgY21kW2NtZC5sZW5ndGggLSAxXS5zaG91bGQuZXFsKCd2YWx1ZSB2YWx1ZTInKTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIHBhcnNlIG9wdGlvbmFsSW50ZW50QXJndW1lbnRzIHdpdGggbXVsdGlwbGUga2V5cycsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBjbWQgPSBidWlsZFN0YXJ0Q21kKF8uZGVmYXVsdHMoe29wdGlvbmFsSW50ZW50QXJndW1lbnRzOiAnLWQga2V5MSAtZSBrZXkyJ30sIHN0YXJ0T3B0aW9ucyksIDIwKTtcbiAgICAgIGNtZFtjbWQubGVuZ3RoIC0gNF0uc2hvdWxkLmVxbCgnLWQnKTtcbiAgICAgIGNtZFtjbWQubGVuZ3RoIC0gM10uc2hvdWxkLmVxbCgna2V5MScpO1xuICAgICAgY21kW2NtZC5sZW5ndGggLSAyXS5zaG91bGQuZXFsKCctZScpO1xuICAgICAgY21kW2NtZC5sZW5ndGggLSAxXS5zaG91bGQuZXFsKCdrZXkyJyk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBwYXJzZSBvcHRpb25hbEludGVudEFyZ3VtZW50cyB3aXRoIG11bHRpcGxlIGtleS92YWx1ZSBwYWlycycsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBjbWQgPSBidWlsZFN0YXJ0Q21kKF8uZGVmYXVsdHMoe29wdGlvbmFsSW50ZW50QXJndW1lbnRzOiAnLWQga2V5MSB2YWx1ZTEgLWUga2V5MiB2YWx1ZTInfSwgc3RhcnRPcHRpb25zKSwgMjApO1xuICAgICAgY21kW2NtZC5sZW5ndGggLSA2XS5zaG91bGQuZXFsKCctZCcpO1xuICAgICAgY21kW2NtZC5sZW5ndGggLSA1XS5zaG91bGQuZXFsKCdrZXkxJyk7XG4gICAgICBjbWRbY21kLmxlbmd0aCAtIDRdLnNob3VsZC5lcWwoJ3ZhbHVlMScpO1xuICAgICAgY21kW2NtZC5sZW5ndGggLSAzXS5zaG91bGQuZXFsKCctZScpO1xuICAgICAgY21kW2NtZC5sZW5ndGggLSAyXS5zaG91bGQuZXFsKCdrZXkyJyk7XG4gICAgICBjbWRbY21kLmxlbmd0aCAtIDFdLnNob3VsZC5lcWwoJ3ZhbHVlMicpO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgcGFyc2Ugb3B0aW9uYWxJbnRlbnRBcmd1bWVudHMgd2l0aCBoeXBoZW5zJywgZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IGFyZyA9ICdodHRwOi8vc29tZS11cmwtd2l0aC1oeXBoZW5zLmNvbS8nO1xuICAgICAgbGV0IGNtZCA9IGJ1aWxkU3RhcnRDbWQoXy5kZWZhdWx0cyh7b3B0aW9uYWxJbnRlbnRBcmd1bWVudHM6IGAtZCAke2FyZ31gfSwgc3RhcnRPcHRpb25zKSwgMjApO1xuICAgICAgY21kW2NtZC5sZW5ndGggLSAyXS5zaG91bGQuZXFsKCctZCcpO1xuICAgICAgY21kW2NtZC5sZW5ndGggLSAxXS5zaG91bGQuZXFsKGFyZyk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBwYXJzZSBvcHRpb25hbEludGVudEFyZ3VtZW50cyB3aXRoIG11bHRpcGxlIGFyZ3VtZW50cyB3aXRoIGh5cGhlbnMnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgYXJnMSA9ICdodHRwOi8vc29tZS11cmwtd2l0aC1oeXBoZW5zLmNvbS8nO1xuICAgICAgbGV0IGFyZzIgPSAnaHR0cDovL3NvbWUtb3RoZXItdXJsLXdpdGgtaHlwaGVucy5jb20vJztcbiAgICAgIGxldCBjbWQgPSBidWlsZFN0YXJ0Q21kKF8uZGVmYXVsdHMoe1xuICAgICAgICBvcHRpb25hbEludGVudEFyZ3VtZW50czogYC1kICR7YXJnMX0gLWUga2V5ICR7YXJnMn1gXG4gICAgICB9LCBzdGFydE9wdGlvbnMpLCAyMCk7XG4gICAgICBjbWRbY21kLmxlbmd0aCAtIDVdLnNob3VsZC5lcWwoJy1kJyk7XG4gICAgICBjbWRbY21kLmxlbmd0aCAtIDRdLnNob3VsZC5lcWwoYXJnMSk7XG4gICAgICBjbWRbY21kLmxlbmd0aCAtIDNdLnNob3VsZC5lcWwoJy1lJyk7XG4gICAgICBjbWRbY21kLmxlbmd0aCAtIDJdLnNob3VsZC5lcWwoJ2tleScpO1xuICAgICAgY21kW2NtZC5sZW5ndGggLSAxXS5zaG91bGQuZXFsKGFyZzIpO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgaGF2ZSAtUyBvcHRpb24gd2hlbiBzdG9wQXBwIGlzIHNldCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBjbWQgPSBidWlsZFN0YXJ0Q21kKF8uZGVmYXVsdHMoe3N0b3BBcHA6IHRydWV9LCBzdGFydE9wdGlvbnMpLCAyMCk7XG4gICAgICBjbWRbY21kLmxlbmd0aCAtIDFdLnNob3VsZC5lcWwoJy1TJyk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBub3QgaGF2ZSAtUyBvcHRpb24gd2hlbiBzdG9wQXBwIGlzIG5vdCBzZXQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgY21kID0gYnVpbGRTdGFydENtZChfLmRlZmF1bHRzKHtzdG9wQXBwOiBmYWxzZX0sIHN0YXJ0T3B0aW9ucyksIDIwKTtcbiAgICAgIGNtZFtjbWQubGVuZ3RoIC0gMV0uc2hvdWxkLm5vdC5lcWwoJy1TJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdnZXRCdWlsZFRvb2xzRGlycycsIGZ1bmN0aW9uICgpIHtcbiAgICBpdCgnc2hvdWxkIHNvcnQgYnVpbGQtdG9vbHMgZm9sZGVyIG5hbWVzIGJ5IHNlbWFudGljIHZlcnNpb24nLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBtb2Nrcy5mcy5leHBlY3RzKCdnbG9iJykub25jZSgpLnJldHVybnMoW1xuICAgICAgICAnL3NvbWUvcGF0aC8xLjIuMycsXG4gICAgICAgICcvc29tZS9wYXRoLzQuNS42JyxcbiAgICAgICAgJy9zb21lL3BhdGgvMi4zLjEnLFxuICAgICAgXSk7XG4gICAgICAoYXdhaXQgZ2V0QnVpbGRUb29sc0RpcnMoJy9kdW1teS9wYXRoJykpLnNob3VsZC5iZS5lcWwoW1xuICAgICAgICAnL3NvbWUvcGF0aC80LjUuNicsXG4gICAgICAgICcvc29tZS9wYXRoLzIuMy4xJyxcbiAgICAgICAgJy9zb21lL3BhdGgvMS4yLjMnLFxuICAgICAgXSk7XG4gICAgfSk7XG4gIH0pO1xufSkpO1xuIl0sImZpbGUiOiJ0ZXN0L3VuaXQvaGVscGVyLXNwZWNzLmpzIiwic291cmNlUm9vdCI6Ii4uLy4uLy4uIn0=
